
- id: sys_info
  stdout: sys.log
  cmd: uname -v

- id: env_info
  stdout: env.log
  after: sys_info
  cmd: env

- id: null_command
  after: env_info
  cmd: null

{% for i in range(5) %}
- id: test_range_{{ loop.index }}
  after: null_command
  cmd: echo {{ loop.index }}
{% endfor %}

{% block main %}
- id: say_hello
  help: >
   This block will be replaced with other tasks if a child template
   is rendered. Otherwise, this task will remain.
  cmd: say Hello, world
{% endblock %}

{% with after = "env_info" %}
{% include "test/show_env.yaml" %}
{% endwith %}

- id: test_nested_workflows
  cmd: jetstream pipelines test/hello_world.yaml

- id: test_log_capture
  cmd: bash
  stdin: |
    #!/bin/bash

    for i in $(seq 10); do
      cat /dev/urandom | head | base64
    done

- id: test_failures
  cmd: bash
  after: test_log_capture
  stdin: |
    #!/bin/bash
    echo 'This task should fail'
    exit 1

- id: test_dependency_failures
  cmd: echo This command should fail due to dependency
  after: test_failures
