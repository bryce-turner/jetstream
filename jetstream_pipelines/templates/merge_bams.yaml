# Requirements
# sample

- id: merge_bams_{{ sample.sample_name }}
  cmd: sbatch_wait -c8
  stdin: |
    #!/bin/bash
    set -eu
    module load gatk/4.0.1.2

    MERGEDBAM="{{ sample.sample_name }}/{{ sample.sample_name }}.merged.bam"

    gatk MergeSamFiles \
      ASSUME_SORTED=true \
      USE_THREADING=true \
      VALIDATION_STRINGENCY=SILENT \
      TMP_DIR=${TMPDIR} \
      {%- for b in sample.data %}
      I={{ b.path }}
      {%- endfor %}
      OUTPUT=${MERGEDBAM}
